<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.8ff3ab33eef33b8515d9.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-fc117160c69a8ea0851b26dd14748ee4.woff2) format("woff2"),url(/static/merriweather-latin-300-58b18067ebbd21fda77b67e73c241d3b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-fe29961474f8dbf77c0aa7b9a629e4bc.woff2) format("woff2"),url(/static/merriweather-latin-300italic-23c3f1f88683618a4fb8d265d33d383a.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-d9479e8023bef9cbd9bf8d6eabd6bf36.woff2) format("woff2"),url(/static/merriweather-latin-400-040426f99ff6e00b86506452e0d1f10b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-2de7bfeaf08fb03d4315d49947f062f7.woff2) format("woff2"),url(/static/merriweather-latin-400italic-79db67aca65f5285964ab332bd65f451.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-4b08e01d805fa35d7bf777f1b24314ae.woff2) format("woff2"),url(/static/merriweather-latin-700-22fb8afba4ab1f093b6ef9e28a9b6e92.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-cd92541b177652fffb6e3b952f1c33f1.woff2) format("woff2"),url(/static/merriweather-latin-700italic-f87f3d87cea0dd0979bfc8ac9ea90243.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-f813fc6a4bee46eda5224ac7ebf1b7be.woff2) format("woff2"),url(/static/merriweather-latin-900-5d4e42cb44410674acd99153d57df032.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-b7901d85486871c1779c0e93ddd85656.woff2) format("woff2"),url(/static/merriweather-latin-900italic-9647f9fdab98756989a8a5550eb205c3.woff) format("woff")}


/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{-webkit-text-size-adjust:100%;line-height:1.15}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden]{display:none}:root{--maxWidth-none:"none";--maxWidth-xs:20rem;--maxWidth-sm:24rem;--maxWidth-md:28rem;--maxWidth-lg:32rem;--maxWidth-xl:36rem;--maxWidth-2xl:42rem;--maxWidth-3xl:48rem;--maxWidth-4xl:56rem;--maxWidth-full:"100%";--maxWidth-wrapper:var(--maxWidth-2xl);--spacing-px:"1px";--spacing-0:0;--spacing-1:0.25rem;--spacing-2:0.5rem;--spacing-3:0.75rem;--spacing-4:1rem;--spacing-5:1.25rem;--spacing-6:1.5rem;--spacing-8:2rem;--spacing-10:2.5rem;--spacing-12:3rem;--spacing-16:4rem;--spacing-20:5rem;--spacing-24:6rem;--spacing-32:8rem;--fontFamily-sans:Montserrat,system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--fontFamily-serif:"Merriweather","Georgia",Cambria,"Times New Roman",Times,serif;--font-body:var(--fontFamily-serif);--font-heading:var(--fontFamily-sans);--fontWeight-normal:400;--fontWeight-medium:500;--fontWeight-semibold:600;--fontWeight-bold:700;--fontWeight-extrabold:800;--fontWeight-black:900;--fontSize-root:16px;--lineHeight-none:1;--lineHeight-tight:1.1;--lineHeight-normal:1.5;--lineHeight-relaxed:1.625;--fontSize-0:0.833rem;--fontSize-1:1rem;--fontSize-2:1.2rem;--fontSize-3:1.44rem;--fontSize-4:1.728rem;--fontSize-5:2.074rem;--fontSize-6:2.488rem;--fontSize-7:2.986rem;--color-primary:#005b99;--color-text:#2e353f;--color-text-light:#4f5969;--color-heading:#1a202c;--color-heading-black:#000;--color-accent:#d1dce5}*,:after,:before{box-sizing:border-box}html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-size:var(--fontSize-root);line-height:var(--lineHeight-normal)}body{color:var(--color-text);font-family:var(--font-body);font-size:var(--fontSize-1)}footer{padding:var(--spacing-6) var(--spacing-0)}hr{background:var(--color-accent);border:0;height:1px}h1,h2,h3,h4,h5,h6{font-family:var(--font-heading);letter-spacing:-.025em;line-height:var(--lineHeight-tight);margin-bottom:var(--spacing-6);margin-top:var(--spacing-12)}h2,h3,h4,h5,h6{color:var(--color-heading);font-weight:var(--fontWeight-bold)}h1{color:var(--color-heading-black);font-size:var(--fontSize-6);font-weight:var(--fontWeight-black)}h2{font-size:var(--fontSize-5)}h3{font-size:var(--fontSize-4)}h4{font-size:var(--fontSize-3)}h5{font-size:var(--fontSize-2)}h6{font-size:var(--fontSize-1)}h1>a,h2>a,h3>a,h4>a,h5>a,h6>a{color:inherit;text-decoration:none}p{--baseline-multiplier:0.179;--x-height-multiplier:0.35;line-height:var(--lineHeight-relaxed);margin:var(--spacing-0) var(--spacing-0) var(--spacing-8) var(--spacing-0)}ol,p,ul{padding:var(--spacing-0)}ol,ul{list-style-image:none;list-style-position:outside;margin-bottom:var(--spacing-8);margin-left:var(--spacing-0);margin-right:var(--spacing-0)}ol li,ul li{padding-left:var(--spacing-0)}li>p,ol li,ul li{margin-bottom:calc(var(--spacing-8)/2)}li :last-child{margin-bottom:var(--spacing-0)}li>ul{margin-left:var(--spacing-8);margin-top:calc(var(--spacing-8)/2)}blockquote{border-left:var(--spacing-1) solid var(--color-primary);color:var(--color-text-light);font-size:var(--fontSize-2);font-style:italic;margin-bottom:var(--spacing-8);margin-left:calc(var(--spacing-6)*-1);margin-right:var(--spacing-8);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-6)}blockquote>:last-child{margin-bottom:var(--spacing-0)}blockquote>ol,blockquote>ul{list-style-position:inside}table{border-collapse:collapse;border-spacing:.25rem;margin-bottom:var(--spacing-8);width:100%}table thead tr th{border-bottom:1px solid var(--color-accent)}a{color:var(--color-primary)}a:focus,a:hover{text-decoration:none}.global-wrapper{margin:var(--spacing-0) auto;max-width:var(--maxWidth-wrapper);padding:var(--spacing-10) var(--spacing-5)}.global-wrapper[data-is-root-path=true] .bio{margin-bottom:var(--spacing-20)}.global-header{margin-bottom:var(--spacing-12)}.main-heading{font-size:var(--fontSize-7);margin:0}.post-list-item{margin-bottom:var(--spacing-8);margin-top:var(--spacing-8)}.post-list-item p{margin-bottom:var(--spacing-0)}.post-list-item h2{color:var(--color-primary);font-size:var(--fontSize-4);margin-bottom:var(--spacing-2);margin-top:var(--spacing-0)}.post-list-item header{margin-bottom:var(--spacing-4)}.header-link-home{font-family:var(--font-heading);font-size:var(--fontSize-2);font-weight:var(--fontWeight-bold);text-decoration:none}.bio{display:flex;margin-bottom:var(--spacing-16)}.bio-avatar,.bio p{margin-bottom:var(--spacing-0)}.bio-avatar{border-radius:100%;margin-right:var(--spacing-4);min-width:50px}.blog-post header h1{margin:var(--spacing-0) var(--spacing-0) var(--spacing-4) var(--spacing-0)}.blog-post header p{font-family:var(--font-heading);font-size:var(--fontSize-2)}.blog-post-nav ul{margin:var(--spacing-0)}.gatsby-highlight{margin-bottom:var(--spacing-8)}@media (max-width:42rem){blockquote{margin-left:var(--spacing-0);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-4)}ol,ul{list-style-position:inside}}.image-container{display:flex;justify-content:center}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-]::selection,code[class*=language-] ::selection,pre[class*=language-]::selection,pre[class*=language-] ::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><meta name="generator" content="Gatsby 3.14.6"/><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link rel="icon" href="/favicon-32x32.png?v=cca28189378354b8d55b64c8e55585f6" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#663399"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=cca28189378354b8d55b64c8e55585f6"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=cca28189378354b8d55b64c8e55585f6"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=cca28189378354b8d55b64c8e55585f6"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=cca28189378354b8d55b64c8e55585f6"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=cca28189378354b8d55b64c8e55585f6"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=cca28189378354b8d55b64c8e55585f6"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=cca28189378354b8d55b64c8e55585f6"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=cca28189378354b8d55b64c8e55585f6"/><title data-react-helmet="true">Packaging a Scala CLI app in 2022 | James Santucci&#x27;s development blog</title><meta data-react-helmet="true" name="description" content="Once upon a time sbt-assembly was the best game in town. Now GraalVM and Node.js are viable bundling alternatives."/><meta data-react-helmet="true" property="og:title" content="Packaging a Scala CLI app in 2022"/><meta data-react-helmet="true" property="og:description" content="Once upon a time sbt-assembly was the best game in town. Now GraalVM and Node.js are viable bundling alternatives."/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content="james_santucci"/><meta data-react-helmet="true" name="twitter:title" content="Packaging a Scala CLI app in 2022"/><meta data-react-helmet="true" name="twitter:description" content="Once upon a time sbt-assembly was the best game in town. Now GraalVM and Node.js are viable bundling alternatives."/><link as="script" rel="preload" href="/webpack-runtime-19a50038384237546ac3.js"/><link as="script" rel="preload" href="/framework-e413e527015be9a1bdfd.js"/><link as="script" rel="preload" href="/app-a9e27704c381083ee903.js"/><link as="script" rel="preload" href="/commons-ab2410dfbec4227df496.js"/><link as="script" rel="preload" href="/component---src-templates-blog-post-js-04cf94ac1e1bc43d9bc7.js"/><link as="fetch" rel="preload" href="/page-data/Packaging-a-Scala-CLI-app-in-2022/Packaging-a-Scala-CLI-app-in-2022/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/2841359383.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/sq/d/3257411868.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="global-wrapper" data-is-root-path="false"><header class="global-header"><a class="header-link-home" href="/">James Santucci&#x27;s development blog</a></header><main><article class="blog-post" itemscope="" itemType="http://schema.org/Article"><header><h1 itemProp="headline">Packaging a Scala CLI app in 2022</h1><p>July 17, 2022</p></header><section itemProp="articleBody"><p>In past work projects, when I’ve been on a team needing a way to package a Scala application,
I’ve relied on <a href="https://github.com/sbt/sbt-assembly"><code class="language-text">sbt-assembly</code></a>. <code class="language-text">sbt-assembly</code> is great
for what it’s for — it bundles up dependencies and application code in a single fat
<code class="language-text">jar</code> file, and you can run it anywhere with a Java runtime (subject to all the normal caveats
about Java versions).</p>
<p>That’s great, but more recently, support for bundling Scala apps in other ways has flourished.
<a href="https://scala-native.readthedocs.io/en/latest/#"><code class="language-text">scala-native</code></a> targets generic POSIX environments,
<a href="https://www.scala-js.org/">Scala.js</a> targets the browser and hit 1.0 in 2020, and GraalVM provides
an alternate Java runtime environment
<a href="https://www.graalvm.org/22.1/docs/getting-started/">“designed to accelerate the execution of applications written in […] JVM languages.”</a>.</p>
<p>Each of those is developed enough
to have its own sbt plugin. Partly because I wanted the tool, and partly because I wanted to play
around with new application bundling options, I used GraalVM and Scala.js to bundle up a CLI
app for adding rainbow brackets to streaming input.</p>
<h2>Rainbow brackets</h2>
<p>Rainbow brackets are great. No one has ever looked at an editor with a rainbow bracket plugin enabled and said
“you know what, too much syntactical info in the bracket colors for me.” However! Not everyone has access to rainbow
brackets everywhere they could. You while Looking at Source Code probably feels an ineffable unease when looking
at monochrome source code. You while Looking at Logs and Waxing Inexplicably French is probably like
“ehhhh it’s an inscrutable mass, que sera sera.”</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/a9ce71d604b203db765cbbf16c6d6eea/8bf8a/log-output.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 48.734177215189874%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAA7DAAAOwwHHb6hkAAACbUlEQVQozwFiAp39APv6+f78/Pv8/f39/f7+/vz8/P7//vv7+/v7+/////7+/v////7+/v39/f////////7+/v7+///9+9Lk+wDh4uLr7OvJzdDm6OnZ2dj6+vrf3tn8/Pzg2t7i4eHf39/o6Onj4+Py8vLg39/g4OD9/fzl5ufr6+ze3NsAgXB7a1Rkc1xsmJidfH6CgYGFkZKUkJCWdXV7hoiLpaWpnZ6hlpaVn5+fiYqKUlNTh4eHfn19YWFeWlpaAFg+TioEHkYjPWNgZj8+RCwrMVlaX0JETxkeKDxBSWNja0tMUkREQ0BAQENDRAAAADM0NT09PB0ZEBwbGwDBvL+8tLrFv8TU1NXKysrNzc7Y2NnKzM26u7zFxcfe3t7T09HR0tHp6enNzMq3trTNzcy7u7yurq2tra0ANTc3ISIhISIhXF1dNzcyGxoZOjo6TExNICAgIyMjUFBOHRwXBgUDYGBgWFVQUU1Hbm1sWlxeMjM0MTExAH19fWNjZFxcXYOFhHFwaFxbWm9vb4GChGJjZG9wcYSEgkpJRTk4N4eHh3d3dWtra46Mimxta7Ozs+Dg4AC/wMC6u7u9vr/Ozc65vb2tsrLBwcG+vr6xrqq1s7DNzs3V2NXS1dLS0tLe3d3n5+bq6unW19igoaWipKgAOzs2Hh4eFxYWU1hYDT09AA8PJyYnW1hQRjkdRzwoWFtXIS4hICsfEA8Qc3N05OPk2tvbwsLEHhgfDg4WALKyr6ioqK2srLm8vJurrJ2mprKzs7y8u7Cwrbm3tMjHx7i4ucHBwcHAwNPT09/f4O7u7+bm6J+eo6KhplbwYHA6y8fhAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="what is this garbage"
        title="what is this garbage"
        src="/static/a9ce71d604b203db765cbbf16c6d6eea/f058b/log-output.png"
        srcset="/static/a9ce71d604b203db765cbbf16c6d6eea/c26ae/log-output.png 158w,
/static/a9ce71d604b203db765cbbf16c6d6eea/6bdcf/log-output.png 315w,
/static/a9ce71d604b203db765cbbf16c6d6eea/f058b/log-output.png 630w,
/static/a9ce71d604b203db765cbbf16c6d6eea/40601/log-output.png 945w,
/static/a9ce71d604b203db765cbbf16c6d6eea/78612/log-output.png 1260w,
/static/a9ce71d604b203db765cbbf16c6d6eea/8bf8a/log-output.png 1901w"
        sizes="(max-width: 630px) 100vw, 630px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>But there’s another way! It turns out matching parentheses problems are not very difficult puzzles.
If you desire in your heart of hearts to have special colors for brackets, parentheses, and braces that
happen to complete each other… you don’t need to suffer in vain, or something.</p>
<h2>The code</h2>
<p>Algorithmically, the CLI is <em>really simple</em>. For some streaming input, if you see a character that opens a
pair like <code class="language-text">[</code>, <code class="language-text">(</code>, or <code class="language-text">{</code>, rewrite it to a special colorized version of that same character and push to a stack.
If you see a character that closes a pair like <code class="language-text">]</code>, <code class="language-text">)</code>, or <code class="language-text">}</code>, rewrite it to a special colorized version of that
same character and pop off a stack.</p>
<p>We have a few fancy options here. I was inspired by Michael Pilquist’s <a href="https://github.com/scodec/hexdump4s"><code class="language-text">hexdump4s</code></a>
and got excited about functional abstractions and <em>doing the right thing</em>™️. I wanted to model the state of the parentheses
counter using either a <code class="language-text">Ref</code> or a <code class="language-text">StateT[Stream[F, *], Color, *]</code>. Fancy values! It turns out I didn’t need fancy values.
I enthusiastically stole the <a href="https://github.com/scodec/hexdump4s/blob/89271648d5d3d325557562df15c32ad6609a8f2b/hexdump4s.scala#L20-L43">“file path or stdin” handling from <code class="language-text">hexdump4s</code></a>, then tracked the state of the color wheel
using a very unsafe, privately immutable <a href="https://github.com/jisantuc/rb-paren-cli/blob/v0.0.1/src/main/scala/io/github/jisantuc/rbparencli/Ring.scala"><code class="language-text">Ring</code></a>
<code class="language-text">trait</code>. It tracks a collection of values with size <code class="language-text">n</code> against an index modulo an internal counter.</p>
<p>With the <code class="language-text">Ring</code> in hand, it was pretty straightforward to handle the rest. <a href="https://github.com/bkirwi/decline"><code class="language-text">decline</code></a> is wonderful
for config / command line argument parsing, <a href="https://github.com/typelevel/fs2"><code class="language-text">fs2</code></a> is the GOAT for constant memory IO,
and <a href="https://github.com/typelevel/cats-parse"><code class="language-text">cats-parse</code></a> is simple and nice for defining shapes of custom string formats
on the fly. The <code class="language-text">decline</code> + <code class="language-text">cats-parse</code> combo was great for defining the shapes of my color arguments. Since CLIs have to deal with horrible string formats all the time, it was great to be able to concissely represent the rules for <em>good</em> strings and hook that into argument parsing.
Note that once we’re in application logic, everything is purely in domain types —
the function responsible for transforming input is <a href="https://github.com/jisantuc/rb-paren-cli/blob/v0.0.1/src/main/scala/io/github/jisantuc/rbparencli/Main.scala#L21-L39"><code class="language-text">colorize</code></a>, and it knows nothing of effects or streaming or arguments, just “if you can give me a palette
and a character, I can color that character.”</p>
<p>The end result looks like this:</p>
<p><span
      class="gatsby-resp-image-wrapper"
      style="position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 472px; "
    >
      <a
    class="gatsby-resp-image-link"
    href="/static/f6f6352f508b161f5c610424aede82c1/3c5de/rainbow-parens.png"
    style="display: block"
    target="_blank"
    rel="noopener"
  >
    <span
    class="gatsby-resp-image-background-image"
    style="padding-bottom: 11.39240506329114%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAA7CAAAOwgEVKEqAAAAAcklEQVQI102I7QqCMAAAff+HG0opOQ2d23St/IBmP1pw0SDwx3HHZbrPaRrBtRUYlbN6yeJrRlPibMVzbrmNVXqLl7y2jvUumUxJ3xVodcIO5+SHu5BtXmC9YnI1YS6Iu+azD7yDSv4RgyKGIfF/R+Khv15MlGpdZ+DKAAAAAElFTkSuQmCC'); background-size: cover; display: block;"
  ></span>
  <img
        class="gatsby-resp-image-image"
        alt="Colored log output, with matching parentheses, brackets, and braces colored"
        title="Colored log output, with matching parentheses, brackets, and braces colored"
        src="/static/f6f6352f508b161f5c610424aede82c1/3c5de/rainbow-parens.png"
        srcset="/static/f6f6352f508b161f5c610424aede82c1/c26ae/rainbow-parens.png 158w,
/static/f6f6352f508b161f5c610424aede82c1/6bdcf/rainbow-parens.png 315w,
/static/f6f6352f508b161f5c610424aede82c1/3c5de/rainbow-parens.png 472w"
        sizes="(max-width: 472px) 100vw, 472px"
        style="width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;"
        loading="lazy"
      />
  </a>
    </span></p>
<p>So that’s the pinnacle of side project completion — <em>it runs on my machine for toy inputs</em>.</p>
<h2>Bundling for linux</h2>
<p>But there are <em>other</em> machines [citation needed], and it’s possible that someone who doesn’t want to learn
how to use <code class="language-text">sbt</code> might want rainbow brackets for their log output. No one has asked me for this, but it’s technically
possible.</p>
<p>I used <a href="https://github.com/sbt/sbt-native-packager"><code class="language-text">sbt-native-packager</code></a> as the packaging plugin, but instead
of following the GraalVM JVM setup guides, I fired up a <code class="language-text">nix repl</code>, loaded up <code class="language-text">nixpkgs</code>, crossed my fingers,
and pressed <code class="language-text">&lt;TAB></code> a few times after typing <code class="language-text">graal</code>. There was a package available (<code class="language-text">graalvm-11-ce</code>) so I added it to <code class="language-text">flake.nix</code>,
, and gave packaging the app up a try.</p>
<p>Cross-project configuration for packaging the app was embarrassingly easy:</p>
<div class="gatsby-highlight" data-language="scala"><pre class="language-scala"><code class="language-scala"><span class="token keyword">lazy</span> <span class="token keyword">val</span> rootJVM <span class="token operator">=</span> root<span class="token punctuation">.</span>jvm
  <span class="token punctuation">.</span>settings<span class="token punctuation">(</span>
    graalVMNativeImageOptions <span class="token operator">++</span><span class="token operator">=</span> Seq<span class="token punctuation">(</span>
      <span class="token comment">// prevents image creation and prints more output when bundling</span>
      <span class="token comment">// is *waves hands* incomplete</span>
      <span class="token string">"--no-fallback"</span><span class="token punctuation">,</span>
      <span class="token comment">// creates basically a fat jar instead of a binary that requires</span>
      <span class="token comment">// path / classpath information to execute</span>
      <span class="token string">"--static"</span><span class="token punctuation">,</span>
      <span class="token comment">// provides nicer logging output when exceptions are encountered</span>
      <span class="token string">"-H:+ReportExceptionStackTraces"</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
    GraalVMNativeImage <span class="token operator">/</span> name <span class="token operator">:</span><span class="token operator">=</span> <span class="token string">"rainbow-parens"</span>
  <span class="token punctuation">)</span>
  <span class="token punctuation">.</span>enablePlugins<span class="token punctuation">(</span>GraalVMNativeImagePlugin<span class="token punctuation">)</span></code></pre></div>
<p>The <code class="language-text">--static</code> option was really important; it was the difference between being able to run the
CLI if I copied it somewhere else on my machine and not being able to run it. However, that’s…
not very many options to specify. If I compare it to common <code class="language-text">sbt-assembly</code> options at least,
it’s <a href="https://github.com/raster-foundry/raster-foundry/blob/1.70.1/build.sbt#L126-L136">fewer lines and less cryptic</a>
than what I’ve wound up with working on other projects.</p>
<h2>Bundling for MacOS</h2>
<p>MacOS is very special and required special handling. <a href="https://www.graalvm.org/22.1/docs/getting-started/macos/">In principle</a>
it should be possible to set up GraalVM packaging on MacOS, but I don’t really know anything
about GraalVM or MacOS, so…</p>
<p><img src="https://media.giphy.com/media/xDQ3Oql1BN54c/giphy.gif" alt="A very good dog floating around a space station"></p>
<p>But there’s another option! <code class="language-text">Scala.js</code> cross-project setups are pretty well ironed out, and all of my dependencies
are cross-published for <code class="language-text">Scala.js</code>, so here’s all I had to do to bundle up a nice <code class="language-text">node.js</code> script:</p>
<div class="gatsby-highlight" data-language="scala"><pre class="language-scala"><code class="language-scala"><span class="token keyword">lazy</span> <span class="token keyword">val</span> root <span class="token operator">=</span>
  <span class="token punctuation">(</span>crossProject<span class="token punctuation">(</span>JSPlatform<span class="token punctuation">,</span> JVMPlatform<span class="token punctuation">)</span><span class="token punctuation">.</span>crossType<span class="token punctuation">(</span>CrossType<span class="token punctuation">.</span>Pure<span class="token punctuation">)</span> in file<span class="token punctuation">(</span><span class="token string">"."</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>settings<span class="token punctuation">(</span>settings<span class="token operator">:</span> _<span class="token operator">*</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>jsSettings<span class="token punctuation">(</span>
      scalaJSUseMainModuleInitializer <span class="token operator">:</span><span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      scalaJSLinkerConfig <span class="token operator">~</span><span class="token operator">=</span> <span class="token punctuation">{</span> _<span class="token punctuation">.</span>withModuleKind<span class="token punctuation">(</span>ModuleKind<span class="token punctuation">.</span>CommonJSModule<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
      Compile <span class="token operator">/</span> fullOptJS <span class="token operator">/</span> artifactPath <span class="token operator">:</span><span class="token operator">=</span> baseDirectory<span class="token punctuation">.</span>value <span class="token operator">/</span> <span class="token string">"rainbow-parens.js"</span>
    <span class="token punctuation">)</span></code></pre></div>
<p>MacOS users have a little more work to do to make sure they can use <code class="language-text">rainbow-parens</code> as a CLI,
but <a href="https://github.com/jisantuc/rb-paren-cli#nodejs-script">not much more work</a>.</p>
<h2>Release and publication</h2>
<p>Because Node.js is basically universal, I didn’t have to split the release workflow. Also,
because I have a <code class="language-text">nix</code> shell available, I don’t have to do much in terms of dependency setup in CI —
instead I can set up <code class="language-text">nix</code> and let it handle making sure I have everything I need.
The bundling step <a href="https://github.com/jisantuc/rb-paren-cli/blob/main/.github/workflows/release.yml#L18-L25">invokes <code class="language-text">sbt</code> commands in a <code class="language-text">nix</code> shell</a>
then points a <a href="https://github.com/ncipollo/release-action">release action</a> at the artifacts.
And we’re done!</p>
<p>This experiment was also a bit inspired by @hillelogram’s <a href="https://twitter.com/hillelogram/status/1514352882807721984">mise en place</a> —
the application here is <em>really simple</em>, so it was fine to take a little more technical risk with the release
tooling. And it worked really well! “Always mise en place” is a good kitchen rule, and it
turns out to work well for taking risk out of future technical choices too.</p></section><hr/><footer><div class="bio"><div data-gatsby-image-wrapper="" style="width:50px;height:50px" class="gatsby-image-wrapper bio-avatar"><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#282828;width:50px;height:50px;position:relative"></div><picture><source type="image/avif" data-srcset="/static/7b5d665746a4df38fcb90999d7de43bb/d4bf4/profile-pic.avif 50w,/static/7b5d665746a4df38fcb90999d7de43bb/ee81f/profile-pic.avif 100w" sizes="50px"/><source type="image/webp" data-srcset="/static/7b5d665746a4df38fcb90999d7de43bb/3faea/profile-pic.webp 50w,/static/7b5d665746a4df38fcb90999d7de43bb/6a679/profile-pic.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" data-src="/static/7b5d665746a4df38fcb90999d7de43bb/d24ee/profile-pic.jpg" data-srcset="/static/7b5d665746a4df38fcb90999d7de43bb/d24ee/profile-pic.jpg 50w,/static/7b5d665746a4df38fcb90999d7de43bb/64618/profile-pic.jpg 100w" alt="Profile picture"/></picture><noscript><picture><source type="image/avif" srcSet="/static/7b5d665746a4df38fcb90999d7de43bb/d4bf4/profile-pic.avif 50w,/static/7b5d665746a4df38fcb90999d7de43bb/ee81f/profile-pic.avif 100w" sizes="50px"/><source type="image/webp" srcSet="/static/7b5d665746a4df38fcb90999d7de43bb/3faea/profile-pic.webp 50w,/static/7b5d665746a4df38fcb90999d7de43bb/6a679/profile-pic.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" src="/static/7b5d665746a4df38fcb90999d7de43bb/d24ee/profile-pic.jpg" srcSet="/static/7b5d665746a4df38fcb90999d7de43bb/d24ee/profile-pic.jpg 50w,/static/7b5d665746a4df38fcb90999d7de43bb/64618/profile-pic.jpg 100w" alt="Profile picture"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div><p>Written by <strong>James Santucci</strong> <!-- -->who lives in Denver and works at Flock Freight pooling shipments into shared truckloads to save the planet, hopefully.<!-- --> <a href="https://twitter.com/james_santucci">You can follow him on Twitter</a></p></div></footer></article><nav class="blog-post-nav"><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/cliffs,-a-small-CLI-for-remembering-what-your-scripts-to-rule-them-all-are-for/cliffs,-a-small-CLI-for-remembering-what-your-scripts-to-rule-them-all-are-for/">← <!-- -->cliffs, a small CLI for remembering what your scripts to rule them all are for</a></li><li><a rel="next" href="/Let-Janja-Garnbret-cook/Let-Janja-Garnbret-cook/">Let Janja cook<!-- --> →</a></li></ul></nav></main><footer>© <!-- -->2023<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.com">Gatsby</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/Packaging-a-Scala-CLI-app-in-2022/Packaging-a-Scala-CLI-app-in-2022/";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-958b67dc2797f3960250.js"],"app":["/app-a9e27704c381083ee903.js"],"component---src-pages-404-js":["/component---src-pages-404-js-bb1698d01a7f9dde5caa.js"],"component---src-pages-index-js":["/component---src-pages-index-js-6ba9a255614174fb4bf1.js"],"component---src-pages-using-typescript-tsx":["/component---src-pages-using-typescript-tsx-56df352fdd68d3ab6a5a.js"],"component---src-templates-blog-post-js":["/component---src-templates-blog-post-js-04cf94ac1e1bc43d9bc7.js"]};/*]]>*/</script><script src="/polyfill-958b67dc2797f3960250.js" nomodule=""></script><script src="/component---src-templates-blog-post-js-04cf94ac1e1bc43d9bc7.js" async=""></script><script src="/commons-ab2410dfbec4227df496.js" async=""></script><script src="/app-a9e27704c381083ee903.js" async=""></script><script src="/framework-e413e527015be9a1bdfd.js" async=""></script><script src="/webpack-runtime-19a50038384237546ac3.js" async=""></script></body></html>